using System;
using System.Diagnostics;
using System.DirectoryServices.Protocols;
using System.Net;

public static class ActiveDirectoryTools
{
    public static LdapConnection? LdapConnection { get; set; }

    static ActiveDirectoryTools() => LdapConnection = null;

    public static void ConnectActiveDirectory(string domain) {
        LdapConnection = new LdapConnection(domain);
    }

    public static void CheckActiveDirectory(string domain)
    {
        if (LdapConnection == null)
        {

        }
    }

    public static Boolean AuthenticateUser(string username, string password)
    {
        NetworkCredential credential = new NetworkCredential(username, password);
        try
        {
            if (LdapConnection != null)
            {
                LdapConnection.Bind(credential);
            }
        }
        catch (LdapException ex)
        {
            Debug.WriteLine(ex.Message);
            return false;
        }
        return true;
    }
}